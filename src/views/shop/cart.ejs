<%- include('../includes/head.ejs'); %>
<div class="cart">
    <h1>Cart</h1>
    <div class="cart-card">
        <% if (cart?.items?.length) { %>
            <ul class="cart-card__list">
                <% cart.items.forEach(product => {%>
                    <li class="cart-item">
                        <span class="cart-item__title"><%= product.productId.title %>: $<%= product.productId.price %></span>
                        <span>QTY: <%= product.quantity %></span>
                        <form action="/cart-delete-item" method="post">
                            <input type="hidden" name="_csrf" value="<%=csrfToken%>">
                            <input type="hidden" name="productId" value="<%= product.productId._id %>" />
                            <button class="main-btn">Delete</button>
                        </form>
                    </li>
                <%})%>
            </ul>
            <h3 class="cart-card__total">Total: $<%= cart.total %></h3>
            <div class="cart-card__action">
                <form action="/create-order" method="POST">
                    <input type="hidden" name="_csrf" value="<%=csrfToken%>">
                    <button type="submit" class="main-btn">Order Now</button>
                </form>
            </div>
        <% } else { %>
            <h2>your cart is empty</h2>
        <% } %>
    </div>
</div>
<%- include('../includes/end.ejs'); %>